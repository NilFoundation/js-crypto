import { ffUtils, poseidon } from '../src';

describe('Poseidon test', () => {
  const str2ArrBuf = (str: string): ArrayBuffer => {
    const buf = new ArrayBuffer(str.length * 2); // 2 bytes for each char
    const bufView = new Uint16Array(buf);
    for (let i = 0, strLen = str.length; i < strLen; i++) {
      bufView[i] = str.charCodeAt(i);
    }
    return buf;
  };

  const str2Bytes = (str: string): Uint8Array => {
    return new Uint8Array(str2ArrBuf(str));
  };

  it('test 2 inputs', () => {
    const inputs = [1, 2].map((v) => BigInt(v));
    const res = poseidon.hash(inputs);
    expect(res.toString(16)).toEqual(
      '115cc0f5e7d690413df64c6b9662e9cf2a3617f2743245519e19607a4417189a'
    );
  });

  it('test 4 inputs', async () => {
    const inputs = [1, 2, 3, 4].map((v) => BigInt(v));
    const res2 = poseidon.hash(inputs);
    expect('299c867db6c1fdd79dcefa40e4510b9837e60ebb1ce0663dbaa525df65250465').toEqual(
      res2.toString(16)
    );
  });

  it('invalid inputs', async () => {
    const inputs = new Array(17).fill(1).map((v) => BigInt(v));
    expect(() => poseidon.hash(inputs)).toThrow(new Error('Invalid inputs'));
  });

  it('test hash bytes', async () => {
    //nolint:lll
    const testVectors: Array<{ bytes: Array<number>; expectedHash: string }> = [
      {
        bytes: [222, 173],
        expectedHash: '244ec1a137a24c92404de9f9c39907be151026a4eb7f9cfea60a5740e8a73b7'
      },
      {
        bytes: [
          206, 14, 142, 80, 38, 0, 177, 75, 176, 162, 201, 104, 159, 125, 147, 209, 14, 159, 84, 81,
          241, 143, 3, 14, 195, 187, 108, 80, 1, 234, 96
        ],
        expectedHash: '3ace829d65dae7903fc9b22e904750ca0509b9a187cbeb004a4270e8322a2f4'
      },
      {
        bytes: [
          52, 102, 82, 137, 183, 26, 44, 184, 191, 76, 40, 154, 230, 209, 125, 132, 84, 87, 196,
          139, 252, 24, 98, 60, 163, 158, 20, 27, 46, 64, 197, 211
        ],
        expectedHash: '144aa8e107a9fd8f8106016a8ff0fd1c265cdf31a40a8ef9ed44dfb4592cbbff'
      },
      {
        bytes: [
          50, 17, 188, 206, 106, 125, 129, 50, 2, 2, 35, 238, 241, 160, 51, 133, 186, 107, 212, 150,
          107, 41, 92, 46, 34, 17, 168, 214, 217, 227, 137, 254, 107, 240, 143, 33, 73, 119, 116,
          69, 107, 226, 228, 127, 219, 103, 64, 170, 87, 19, 56, 199, 28, 56, 192, 166, 215, 247, 3,
          0, 117, 105, 230, 64, 49, 99, 62, 199, 200, 239, 43, 162, 90, 214, 162, 72, 64, 61, 235,
          105, 116, 87, 250, 232, 164, 167, 244, 82, 93, 115, 163, 212, 205, 147, 51, 74, 137, 78,
          251, 178, 13, 10, 99, 145, 223, 10, 174, 70, 188, 50, 0, 88, 52, 237, 8, 74, 235, 8, 136,
          126, 8, 235, 103, 205, 224, 4, 254, 166, 248, 3, 107, 6, 31, 168, 203, 114, 70, 175, 36,
          88, 164, 206, 247, 156, 100, 139, 19, 239, 138, 197, 13, 154, 136, 99, 190, 28, 88, 167,
          169, 165, 148, 0, 6, 2, 38, 17, 202, 53, 80, 139, 153, 54, 86, 207, 63, 208, 23, 85, 121,
          198, 152, 52, 20, 112, 17, 52, 204, 11, 236, 197, 19, 100, 40, 157, 71, 117, 183, 27, 103,
          242, 105, 161, 111, 230, 83, 160, 10, 183, 88, 133, 146, 71, 119, 254, 170, 153, 12, 206,
          156, 86, 24, 2, 88, 27, 144, 146, 233, 190, 42, 13, 3, 253, 134, 54, 30, 66, 123, 148,
          216, 96, 10, 126, 220, 103, 194, 99, 179, 90, 11, 230, 131, 126, 117, 1, 117, 181, 3, 20,
          199, 212, 100, 37, 52, 179, 35, 60, 150, 62, 57, 127, 99, 230, 215, 24, 123, 17, 78, 239,
          19, 70, 65, 45, 232, 57, 147, 203, 121, 188, 128, 233, 169, 33, 250, 89, 204, 204, 218,
          48, 229, 112, 37, 204, 170, 8, 48, 225, 235, 30, 165, 200, 124, 166, 252, 136, 122, 237,
          171, 218, 177, 187, 76, 246, 2, 36, 64, 150, 11, 14, 3, 245, 222, 133, 19, 125, 72, 57,
          40, 115, 133, 29, 19, 248, 3, 91, 103, 230, 165, 245, 197, 186, 199, 89, 143, 226, 249,
          22, 115, 243, 135, 91, 64, 250, 173, 67, 53, 120, 98, 183, 110, 156, 96, 98, 179, 52, 47,
          25, 155, 236, 22, 94, 48, 147, 184, 194, 94, 33, 172, 98, 109, 113, 142, 138, 170, 13,
          138, 172, 192, 52, 162, 218, 74, 111, 243, 222, 54, 137, 29, 221, 48, 178, 42, 190, 223,
          15, 114, 180, 147, 233, 241, 106, 170, 101, 253, 222, 255, 131, 97, 43, 29, 7, 152, 158,
          29, 109, 27, 167, 96, 1, 35, 100, 92, 89, 32, 245, 86, 120, 207, 81, 141, 143, 88, 215,
          61, 98, 39, 231, 16, 188, 246, 223, 207, 227, 9, 197, 214, 126, 79, 81, 251, 177, 138,
          163, 146, 44, 7, 195, 94, 95, 239, 166, 108, 12, 87, 85, 61, 90, 185, 227, 35, 89, 16, 49,
          236, 251, 11, 132
        ],
        expectedHash: '25c9473a28eaf3d42fa89c218ac91da88311cd762272ddedc79645696face6d8'
      },
      {
        bytes: [
          231, 25, 12, 39, 242, 173, 251, 100, 59, 219, 170, 104, 107, 131, 114, 223, 158, 129, 50,
          208, 121, 100, 13, 67, 242, 24, 191, 227, 184, 250, 250, 207, 224, 215, 133, 93, 119, 204,
          25, 94, 5, 216, 85, 210, 216, 40, 230, 39, 190, 48, 91, 52, 244, 222, 82, 137, 77, 54,
          114, 81, 95, 46, 29, 207, 212, 230, 144, 154, 84, 6, 213, 219, 223, 243, 30, 56, 210, 64,
          2, 153, 220, 106, 95, 37, 9, 5, 44, 118, 57, 61, 87, 167, 134, 175, 197, 28, 24, 214, 60,
          155, 210, 237, 215, 11, 141, 130, 248, 103, 197, 38, 149, 86, 166, 54, 209, 200, 199, 251,
          69, 136, 74, 223, 38, 76, 154, 230, 71, 49, 223, 172, 33, 239, 178, 157, 205, 219, 91,
          239, 102, 20, 159, 122, 245, 95, 2, 99, 220, 22, 247, 205, 143, 88, 243, 235, 31, 27, 82,
          70, 167, 106, 230, 76, 207, 119, 49, 223, 14, 23, 150, 62, 250, 75, 120, 109, 51, 101,
          162, 242, 173, 253, 135, 118, 125, 59, 223, 161, 4, 196, 67, 194, 192, 235, 121, 212, 8,
          207, 4, 105, 181, 146, 242, 134, 57, 136, 190, 232, 180, 46, 153, 85, 37, 92, 61, 99, 46,
          223, 26, 61, 226, 163, 5, 245, 115, 17, 37, 117, 244, 149, 129, 146, 241, 180, 51, 8, 159,
          217, 40, 220, 143, 56, 38, 63, 67, 190, 109, 124, 184, 58, 203, 228, 172, 43, 192, 212,
          79, 33, 158, 219, 252, 175, 170, 41, 250, 189, 164, 200, 180, 26, 221, 37, 37, 250, 56,
          152, 38, 73, 252, 34, 239, 18, 33, 39, 52, 65, 230, 92, 230, 46, 162, 0, 237, 149, 26, 22,
          25, 238, 108, 5, 55, 147, 9, 103, 136, 192, 148, 6, 178, 249, 189, 9, 213, 121, 220, 31,
          239, 95, 68, 186, 145, 70, 15, 147, 170, 242, 120, 191, 63, 77, 37, 83, 108, 30, 207, 58,
          246, 79, 131, 167, 160, 78, 192, 73, 229, 79, 250, 0, 119, 33, 207, 193, 163, 54, 8, 152,
          36, 191, 243, 162, 63, 57, 66, 18, 52, 186, 26, 95, 97, 19, 234, 224, 187, 251, 246, 169,
          41, 93, 93, 71, 56, 56, 166, 218, 227, 227, 70, 32, 191, 54, 95, 245, 136, 161, 235, 206,
          108, 91, 249, 196, 96, 56, 165, 243, 35, 210, 59, 167, 236, 93, 154, 252, 72, 18, 118, 18,
          238, 195, 98, 15, 255, 116, 114, 220, 52, 47, 78, 86, 213, 227, 111, 217, 16, 166, 110,
          200, 217, 94, 173, 63, 6, 235, 71, 246, 18, 6, 62, 164, 214, 75, 144, 188, 245, 241, 153,
          104, 78, 153, 249, 135, 50, 2, 148, 120, 217, 149, 5, 202, 115, 184, 110, 12, 244, 181,
          28, 99, 217, 205, 178, 79, 180, 245, 73, 8, 228, 203, 152, 174, 192, 175, 117, 135, 178,
          164, 185, 71, 112, 97, 242
        ],
        expectedHash: '51a6d9a46fe012bc06cc958a1337cb41a4d7b91f9400cea458f37af18be222e'
      },
      {
        bytes: [
          130, 70, 175, 40, 15, 24, 99, 180, 234, 191, 55, 165, 72, 206, 118, 74, 41, 111, 216, 27,
          229, 178, 60, 79, 192, 78, 227, 84, 12, 129, 167, 101, 199, 149, 200, 190, 237, 196, 166,
          161, 214, 122, 83, 252, 201, 82, 91, 194, 226, 211, 19, 105, 252, 100, 224, 245, 71, 164,
          222, 68, 189, 49, 42, 241, 40, 134, 4, 253, 24, 61, 187, 82, 187, 221, 68, 92, 232, 112,
          194, 75, 130, 144, 7, 22, 42, 67, 142, 178, 47, 191, 176, 137, 57, 244, 179, 20, 248, 111,
          38, 77, 23, 18, 108, 253, 28, 213, 0, 40, 238, 197, 170, 189, 155, 177, 245, 199, 89, 147,
          139, 2, 240, 217, 209, 203, 204, 196, 101, 87, 53, 182, 92, 248, 12, 173, 60, 227, 250,
          179, 127, 172, 88, 51, 101, 45, 104, 214, 51, 163, 209, 44, 224, 36, 233, 209, 109, 31,
          168, 160, 197, 186, 128, 114, 40, 110, 133, 85, 148, 71, 18, 85, 223, 254, 150, 168, 117,
          104, 80, 24, 19, 186, 193, 102, 169, 47, 53, 106, 179, 128, 50, 9, 126, 90, 104, 64, 107,
          194, 47, 174, 230, 219, 88, 245, 174, 54, 242, 78, 135, 126, 167, 42, 93, 198, 151, 140,
          74, 92, 127, 103, 30, 99, 94, 196, 67, 13, 161, 253, 46, 158, 149, 135, 178, 168, 182, 75,
          132, 17, 8, 243, 245, 199, 175, 59, 233, 254, 249, 233, 64, 71, 139, 2, 19, 82, 5, 83, 32,
          213, 91, 178, 191, 41, 42, 30, 121, 97, 84, 197, 229, 48, 40, 74, 22, 221, 165, 174, 178,
          155, 172, 165, 132, 247, 100, 135, 207, 32, 245, 187, 64, 156, 251, 98, 71, 166, 145, 142,
          191, 141, 241, 200, 84, 85, 26, 33, 132, 205, 6, 223, 87, 6, 178, 251, 77, 146, 167, 12,
          236, 232, 235, 75, 206, 233, 25, 52, 240, 156, 3, 16, 239, 203, 255, 45, 188, 154, 165,
          182, 234, 129, 141, 150, 244, 113, 249, 2, 92, 180, 110, 74, 205, 152, 164, 236, 198, 221,
          45, 100, 114, 130, 240, 90, 44, 88, 111, 254, 75, 148, 172, 18, 243, 107, 214, 92, 246,
          243, 144, 61, 2, 40, 249, 45, 243, 64, 175, 180, 37, 172, 197, 223, 132, 51, 64, 125, 230,
          151, 164, 74, 119, 128, 80, 104, 150, 121, 156, 93, 202, 19, 158, 217, 73, 136, 128, 197,
          177, 119, 57, 133, 156, 48, 180, 202, 167, 148, 89, 132, 211, 215, 212, 200, 69, 10, 209,
          192, 243, 124, 80, 242, 128, 252, 228, 95, 121, 31, 254, 18, 177, 153, 234, 178, 78, 202,
          71, 34, 62, 252, 220, 134, 215, 100, 181, 127, 179, 175, 205, 196, 176, 27, 111, 53, 163,
          119, 63, 3, 49, 145, 43, 218, 59, 163, 109, 112, 90, 142, 165, 6, 201, 157, 87, 50, 85,
          35, 63, 19, 235, 166, 216, 130, 128, 212, 191, 38, 210, 68, 25, 252, 155, 147, 19, 155,
          116, 136, 13, 64, 124, 183, 150, 194, 214, 209, 56, 91, 106, 69, 109, 215, 171, 87, 85,
          168, 70, 89, 114, 174, 29, 46, 52, 213, 10, 48, 43, 177, 97, 124, 215, 82, 81, 248, 58,
          240, 242, 190, 72, 45, 41, 183, 139, 155, 67, 32, 172, 207, 28, 69, 64, 123, 193, 178,
          198, 219, 189, 38, 168, 216, 129, 28, 169, 91, 216, 142, 89, 190, 209, 154, 22, 58, 184,
          138, 93, 155, 62, 40, 110, 179, 180, 207, 126, 163, 136, 211, 45, 97, 62, 15, 22, 51, 21,
          112, 185, 63, 231, 158, 188, 34, 30, 143, 168, 235, 34, 224, 139, 32, 82, 55, 67, 94, 83,
          149, 25, 139, 239, 77, 38, 73, 83, 179, 251, 215, 44, 118, 22, 3, 241, 179, 67, 230, 35,
          99, 54, 157, 211, 241, 195, 130, 72, 118, 85, 253, 235, 106, 186, 49, 79, 80, 4, 102, 254,
          163, 41, 62, 246, 254, 239, 69, 139, 250, 236, 119, 246, 241, 243, 206, 53, 37, 183, 254,
          45, 244, 51, 176, 115, 48, 209, 121, 235, 66, 119, 57, 120, 44, 149, 200, 118, 122, 177,
          19, 68, 66, 8, 163, 10, 78, 120, 230, 225, 136, 105, 151, 42, 65, 46, 242, 143, 57, 37,
          188, 184, 87, 224, 113, 110, 102, 129, 77, 195, 26, 188, 55, 191, 32, 33, 158, 185, 198,
          15, 53, 239, 78, 31, 16, 183, 56, 137, 201, 9, 72, 103, 216, 19, 161, 88, 208, 172, 179,
          130, 57, 218, 14, 63, 109, 29, 136, 101, 254, 73, 9, 157, 253, 182, 203, 124, 85, 22, 13,
          219, 129, 208, 208, 164, 49, 238, 192, 236, 193, 159, 135, 140, 249, 47, 42, 154, 88, 217,
          81, 229, 180, 168, 227, 184, 232, 119, 86, 87, 123, 21, 122, 236, 11, 57, 17, 250, 56,
          129, 79, 199, 82, 201, 55, 123, 152, 188, 68, 119, 23, 43, 162, 169, 130, 63, 51, 160, 13,
          80, 253, 225, 107, 20, 140, 152, 21, 247, 14, 112, 87, 225, 129, 199, 87, 236, 222, 217,
          176, 227, 29, 53, 210, 199, 112, 125, 222, 125, 133, 94, 108, 242, 181, 245, 73, 98, 41
        ],
        expectedHash: '189569b8bb6878bc0eac1136913cd74eb5fa744bd54c7fc473ffe333e196bfb2'
      },
      {
        bytes: [
          36, 188, 207, 34, 247, 23, 132, 118, 188, 48, 196, 203, 105, 11, 177, 223, 54, 46, 37,
          139, 176, 122, 14, 134, 41, 16, 86, 137, 7, 129, 91, 94, 39, 107, 126, 61, 243, 233, 77,
          69, 134, 95, 55, 186, 19, 175, 81, 47, 66, 175, 224, 42, 91, 255, 199, 117, 232, 95, 52,
          131, 191, 38, 166, 7, 121, 152, 93, 55, 19, 3, 5, 68, 201, 136, 26, 84, 232, 21, 73, 253,
          240, 239, 163, 117, 41, 179, 252, 68, 22, 254, 173, 62, 251, 170, 146, 27, 136, 209, 130,
          202, 44, 174, 63, 5, 82, 162, 37, 51, 225, 190, 54, 99, 112, 142, 78, 249, 26, 216, 42,
          84, 170, 59, 63, 59, 182, 162, 74, 42, 41, 111, 50, 0, 134, 182, 233, 161, 13, 236, 62,
          95, 103, 184, 204, 53, 140, 165, 8, 109, 143, 58, 132, 251, 12, 169, 1, 103, 150, 74, 156,
          234, 38, 170, 49, 250, 184, 98, 216, 98, 99, 34, 31, 103, 229, 46, 229, 252, 74, 41, 160,
          182, 224, 68, 114, 247, 24, 231, 107, 106, 25, 246, 73, 61, 84, 13, 162, 81, 58, 85, 71,
          249, 100, 154, 79, 119, 220, 153, 224, 187, 11, 30, 104, 13, 166, 159, 162, 221, 158, 194,
          179, 177, 30, 55, 91, 201, 147, 211, 0, 173, 252, 215, 252, 79, 232, 117, 170, 77, 41,
          120, 0, 21, 251, 119, 199, 189, 19, 90, 164, 158, 98, 145, 112, 67, 20, 122, 49, 136, 236,
          229, 135, 248, 141, 160, 111, 230, 152, 121, 61, 30, 59, 29, 124, 237, 217, 59, 18, 102,
          79, 83, 222, 254, 235, 204, 219, 129, 111, 145, 250, 210, 255, 241, 33, 76, 151, 230, 29,
          26, 198, 23, 143, 39, 130, 115, 214, 86, 162, 9, 164, 235, 31, 83, 47, 195, 76, 232, 8,
          147, 42, 222, 48, 92, 39, 162, 27, 237, 11, 254, 69, 149, 54, 79, 110, 100, 98, 115, 47,
          117, 252, 133, 102, 187, 141, 29, 111, 236, 52, 34, 143, 81, 12, 187, 31, 114, 41, 60, 93,
          60, 217, 203, 56, 177, 247, 125, 183, 214, 127, 239, 16, 50, 243, 146, 177, 86, 195, 161,
          200, 54, 131, 7, 188, 193, 132, 59, 26, 118, 97, 99, 4, 23, 40, 156, 97, 212, 68, 87, 173,
          100, 85, 200, 77, 115, 219, 69, 23, 231, 113, 234, 138, 32, 65, 17, 62, 153, 16, 201, 220,
          100, 191, 186, 201, 231, 246, 86, 48, 20, 198, 93, 206, 34, 127, 79, 17, 184, 7, 19, 133,
          218, 179, 11, 197, 196, 227, 85, 60, 73, 25, 161, 241, 67, 2, 180, 145, 16, 104, 68, 206,
          91, 123, 88, 116, 216, 121, 254, 216, 232, 127, 243, 237, 243, 174, 4, 242, 183, 122, 212,
          161, 128, 81, 49, 124, 172, 119, 60, 56, 0, 189, 250, 207, 89, 160, 39, 168, 118, 228,
          113, 184, 195, 93, 52, 138, 102, 144, 214, 36, 29, 71, 17, 159, 176, 196, 68, 72, 240, 62,
          32, 48, 198, 153, 154, 72, 243, 1, 14, 109, 133, 80, 53, 100, 211, 175, 149, 70, 113, 208,
          146, 31, 205, 100, 211, 123, 147, 122, 64, 217, 7, 12, 161, 185, 228, 31, 76, 252, 30, 41,
          185, 148, 111, 193, 3, 65, 139, 234, 185, 250, 217, 18, 1, 207, 0, 193, 58, 89, 0, 234,
          42, 164, 209, 116, 252, 123, 187, 190, 241, 205, 52, 184, 180, 245, 133, 62, 190, 217, 69,
          127, 237, 136, 100, 87, 117, 200, 179, 244, 102, 164, 116, 116, 99, 56, 189, 42, 55, 38,
          62, 81, 138, 83, 141, 181, 14, 116, 201, 244, 206, 153, 110, 62, 108, 205, 81, 83, 211,
          242, 99, 127, 81, 174, 178, 112, 24, 240, 250, 249, 238, 1, 118, 108, 20, 186, 134, 10,
          104, 149, 2, 69, 152, 120, 231, 56, 58, 158, 49, 73, 33, 35, 125, 205, 150, 142, 160, 48,
          131, 200, 230, 104, 86, 120, 157, 213, 233, 168, 208, 177, 220, 220, 163, 124, 146, 98,
          57, 27, 245, 148, 63, 95, 205, 143, 194, 70, 55, 226, 59, 145, 204, 239, 228, 133, 220,
          25, 196, 234, 100, 90, 20, 197, 245, 134, 190, 96, 100, 136, 238, 160, 19, 7, 200, 134,
          183, 200, 249, 118, 7, 28, 88, 194, 232, 245, 196, 228, 148, 164, 244, 55, 213, 105, 98,
          113, 253, 215, 255, 13, 133, 218, 3, 240, 209, 81, 229, 6, 22, 118, 136, 118, 65, 162,
          209, 120, 202, 196, 74, 243, 142, 5, 136, 191, 172, 251, 113, 199, 151, 118, 29, 114, 253,
          210, 162, 94, 225, 161, 129, 84, 143, 149, 212, 16, 205, 186, 178, 150, 143, 238, 59, 53,
          174, 232, 205, 185, 254, 252, 52, 79, 140, 197, 84, 56, 76, 42, 175, 37, 184, 39, 122,
          185, 101, 210, 252, 39, 101, 19, 97, 199, 162, 54, 8, 39, 122, 47, 178, 34, 48, 161, 92,
          254, 105, 134, 13, 33, 150, 3, 221, 55, 243, 216, 25, 245, 135, 122, 167, 50, 234, 103,
          211, 111, 100, 87, 97, 66, 70, 248, 255, 17, 163, 239, 24, 214, 64, 87, 143, 47, 149, 136,
          122, 77, 204, 17, 82, 224, 46, 81, 175, 240, 177, 168, 7, 198, 151, 59, 180, 126, 179, 21,
          217, 34, 168, 251, 176, 14, 185, 38, 180, 196, 104, 39, 249, 196, 129, 144, 251, 185, 77,
          71, 149, 227, 223, 190, 27, 135, 142, 21, 181, 216, 221, 218, 206, 127, 130, 69, 29, 228,
          92, 245, 100, 168, 91, 234, 223, 23, 104, 238, 37, 187, 163, 225, 247, 244, 30, 168, 95,
          7, 83, 78, 103, 226
        ],
        expectedHash: '2a61df8c7495a7cb0f575c457c21c072bc69ebd1393aebd903c9a882df1b1d7b'
      },
      {
        bytes: [
          171, 143, 253, 50, 36, 173, 33, 196, 0, 159, 110, 103, 169, 4, 114, 9, 243, 56, 248, 143,
          79, 41, 188, 255, 203, 118, 150, 149, 208, 150, 59, 133, 156, 89, 31, 133, 181, 112, 133,
          140, 46, 177, 98, 98, 163, 192, 124, 163, 35, 237, 10, 231, 98, 198, 119, 46, 79, 52, 148,
          3, 108, 130, 167, 31, 27, 85, 105, 190, 21, 61, 27, 6, 156, 238, 205, 95, 216, 143, 32,
          85, 205, 164, 217, 166, 81, 183, 12, 127, 115, 106, 79, 181, 168, 235, 56, 61, 184, 5, 48,
          230, 8, 206, 1, 254, 82, 149, 107, 165, 235, 226, 128, 26, 230, 3, 9, 196, 216, 64, 33,
          131, 149, 68, 147, 53, 89, 23, 140, 168, 75, 156, 187, 83, 207, 249, 168, 49, 214, 9, 141,
          117, 237, 88, 3, 82, 247, 5, 119, 71, 156, 38, 100, 67, 104, 105, 35, 89, 98, 128, 163,
          110, 139, 129, 27, 133, 143, 105, 215, 153, 102, 210, 84, 138, 178, 216, 48, 253, 16, 1,
          11, 150, 136, 137, 171, 190, 203, 134, 90, 246, 217, 246, 174, 110, 149, 53, 57, 0, 194,
          194, 96, 167, 47, 58, 227, 38, 96, 193, 68, 145, 186, 122, 151, 249, 137, 111, 99, 247,
          242, 157, 2, 18, 18, 164, 193, 129, 72, 163, 134, 239, 96, 182, 177, 109, 131, 70, 69,
          226, 254, 108, 146, 121, 250, 188, 0, 86, 22, 138, 171, 44, 2, 62, 163, 68, 59, 196, 234,
          98, 24, 95, 3, 115, 1, 33, 226, 223, 140, 208, 21, 202, 218, 224, 177, 221, 149, 247, 35,
          247, 56, 175, 8, 201, 248, 215, 212, 127, 53, 214, 78, 88, 10, 215, 214, 82, 90, 91, 150,
          72, 84, 63, 215, 82, 213, 194, 126, 60, 94, 239, 222, 85, 163, 216, 103, 217, 129, 7, 218,
          21, 19, 153, 214, 184, 113, 140, 246, 98, 224, 117, 98, 2, 84, 71, 179, 126, 191, 56, 84,
          237, 238, 47, 183, 76, 81, 39, 61, 119, 90, 212, 164, 236, 224, 78, 200, 64, 255, 179,
          175, 94, 24, 73, 39, 238, 100, 76, 229, 163, 200, 114, 202, 53, 75, 239, 113, 135, 121,
          112, 98, 32, 110, 139, 29, 151, 181, 153, 64, 26, 202, 155, 64, 29, 114, 226, 97, 28, 207,
          221, 115, 197, 148, 167, 196, 170, 140, 171, 211, 212, 49, 33, 44, 204, 21, 18, 239, 208,
          204, 167, 88, 217, 101, 11, 83, 252, 60, 218, 73, 199, 79, 106, 4, 139, 148, 122, 63, 72,
          233, 44, 39, 2, 162, 241, 213, 133, 129, 120, 32, 169, 236, 239, 227, 252, 144, 51, 42,
          113, 136, 81, 201, 106, 118, 29, 97, 57, 93, 132, 191, 120, 102, 134, 46, 165, 124, 141,
          73, 164, 228, 23, 175, 218, 229, 64, 184, 246, 7, 234, 199, 188, 68, 80, 163, 236, 48,
          226, 140, 136, 137, 189, 80, 160, 54, 192, 62, 99, 55, 53, 183, 147, 221, 96, 48, 136, 6,
          97, 224, 161, 117, 105, 55, 255, 149, 86, 165, 45, 232, 4, 239, 95, 195, 129, 178, 155,
          115, 248, 191, 189, 19, 168, 178, 21, 90, 217, 25, 188, 168, 238, 31, 92, 230, 209, 10,
          96, 129, 84, 230, 247, 159, 172, 164, 213, 237, 160, 104, 191, 113, 191, 49, 249, 68, 202,
          92, 152, 186, 202, 74, 93, 122, 20, 29, 144, 1, 220, 177, 128, 55, 227, 6, 103, 238, 209,
          142, 57, 161, 235, 42, 208, 18, 76, 13, 198, 180, 211, 175, 228, 33, 186, 234, 114, 210,
          193, 90, 101, 140, 86, 81, 193, 80, 182, 126, 121, 197, 153, 131, 156, 160, 10, 244, 54,
          131, 63, 101, 219, 152, 99, 89, 89, 21, 127, 112, 68, 109, 223, 87, 142, 193, 167, 28, 72,
          95, 11, 251, 176, 113, 178, 50, 38, 161, 202, 52, 218, 52, 207, 102, 192, 157, 150, 157,
          208, 26, 220, 101, 239, 223, 146, 34, 208, 117, 231, 135, 48, 83, 224, 41, 133, 11, 171,
          133, 92, 220, 79, 21, 24, 10, 85, 113, 215, 87, 156, 139, 197, 244, 112, 250, 75, 42, 158,
          209, 84, 197, 5, 165, 19, 229, 240, 134, 124, 211, 2, 216, 182, 230, 73, 35, 112, 121,
          183, 238, 6, 64, 254, 43, 90, 200, 222, 105, 77, 168, 114, 33, 167, 23, 125, 195, 22, 194,
          234, 71, 193, 237, 182, 167, 105, 159, 54, 81, 169, 159, 67, 206, 42, 136, 81, 70, 208, 6,
          188, 184, 40, 100, 80, 130, 35, 33, 61, 147, 14, 150, 59, 19, 5, 183, 37, 88, 7, 188, 95,
          147, 73, 141, 131, 47, 94, 210, 36, 195, 133, 37, 58, 237, 59, 131, 84, 197, 17, 195, 218,
          254, 161, 61, 60, 213, 224, 5, 35, 240, 10, 123, 240, 92, 42, 101, 250, 35, 192, 172, 145,
          93, 112, 152, 37, 77, 220, 130, 26, 111, 61, 247, 180, 216, 170, 121, 180, 218, 86, 180,
          97, 115, 130, 237, 17, 220, 139, 5, 97, 251, 3, 122, 16, 197, 249, 145, 122, 104, 234, 93,
          29, 142, 123, 15, 236, 17, 98, 139, 140, 228, 147, 184, 255, 116, 38, 205, 108, 67, 237,
          197, 142, 128, 185, 139, 56, 27, 224, 57, 154, 81, 161, 70, 4, 31, 82, 219, 46, 177, 196,
          253, 227, 204, 166, 14, 222, 83, 5, 12, 155, 215, 46, 103, 202, 65, 21, 91, 26, 193, 80,
          138, 180, 5, 91, 64, 83, 6, 74, 244, 75, 142, 49, 193, 98, 212, 71, 147, 94, 245, 216, 33,
          234, 16, 133, 54, 115, 61, 148, 147, 99, 226, 137, 128, 215, 139, 4, 118, 166, 9, 41, 104,
          247
        ],
        expectedHash: '2b07135db61f6943328ef48524aefabf74a44246b543d5bd90d250fafc8b0f78'
      }
    ];

    testVectors.forEach(({ bytes, expectedHash }) => {
      expect(poseidon.hashBytes(new Uint8Array(bytes)).toString(16)).toEqual(expectedHash);
    });
  });
});
